{% extends "base_map_split.html" %}

{% block details %} 
	<h2> {{ user.first_name }}'s Alert History: 	</h2> 

 <table border="1" id="alert_table">
	<tr id="alert_table_header" >
		<th></th>
		<th>Alert</th>
		<th>Time</th>
		<th>Read</th>
	</tr>
	{% for alertGroup in alertsArrays %}
		{% for alertLog in alertGroup %}
			{% if forloop.counter = 1 %}
			<tr class="parent" id="row{{ forloop.parentloop.counter }}">
			<td id="imgtd{{ forloop.parentloop.counter }}" style="cursor:hand" onclick="showHideRows('child-row{{ forloop.parentloop.counter }}',parentRowPic{{ forloop.parentloop.counter }})"><span><img id="parentRowPic{{ forloop.parentloop.counter }}" src="{{ STATIC_URL }}img/expand.gif"></span></td>
			<td>{{alertLog.alert}}</td>
			<td>{{alertLog.location_log.timestamp|date:"d/m/y-H:f:s"}}</td>
			<td> <input type="checkbox" id="rowCheckBox{{ forloop.parentloop.counter }}"/></td>
			</tr>
			{%else%}
			<tr class="child-row{{ forloop.parentloop.counter }}"; style="display:none;">
			<td>&nbsp;</td>
			<td></td>
			<td>{{alertLog.location_log.timestamp|date:"d/m/y-H:f:s"}}</td>
			<td></td>
			</tr>
			{%endif%}
		{% endfor %}
	{% endfor %}
</table>	





	
{% endblock details %}


{% block extendedFunction %}
function extendedFunction()
{  
	var marker;
	{% if alertsArrays %}
		{% for alertGroup in alertsArrays %}{% for alertLog in alertGroup %}
				marker = createMarker(
				new google.maps.LatLng({{ alertLog.location_log.lat }},{{ alertLog.location_log.long }}),
				'{{ alertLog.location_log.timestamp }} <br> {{ alertLog.location_log.speed }} kph',
				'{{ alertLog.location_log.timestamp }}',
				"{{ STATIC_URL }}img/spot.png",
				{{ forloop.counter }},{{forloop.parentloop.counter}}-1);
				markerArray[{{forloop.parentloop.counter}}-1][{{forloop.counter}}] = marker;
				latlngbounds.extend( marker.getPosition() );
			{% endfor %}
				AddLine({{ forloop.counter }}-1 , 0);//(lineNumber , reverse=false);
				var row = document.getElementById("imgtd{{ forloop.counter }}").style.backgroundColor = lineColors[{{ forloop.counter }}-1];;
		{% endfor %}
				map.fitBounds( latlngbounds );
	{% endif %}

}
{% endblock extendedFunction%}							
